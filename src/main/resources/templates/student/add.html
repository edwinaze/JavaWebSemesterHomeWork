<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>添加学生信息 - 后台管理系统</title>
  <link rel="icon" href="favicon.ico" type="image/ico">
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/materialdesignicons.min.css" rel="stylesheet">
  <link href="/css/style.min.css" rel="stylesheet">
  <link href="/css/parsley.css" rel="stylesheet">
<!--  对话框样式-->
  <link rel="stylesheet" href="/js/jconfirm/jquery-confirm.min.css">

</head>
  
<body>
<div class="layout-web">
  <div class="layout-container">
    <!--左侧导航-->
    <aside class="layout-sidebar">
      
      <!-- logo -->
      <div id="logo" class="sidebar-header">
        <a href="/index"><img src="/images/logo-sidebar.png" title="LightYear" alt="LightYear" /></a>
      </div>
      <div class="layout-sidebar-scroll"> 
        
        <nav class="sidebar-main">
          <ul class="nav nav-drawer">
            <li class="nav-item active"> <a href="/index"><i class="mdi mdi-home"></i> 后台首页</a> </li>
            <li class="nav-item nav-item-has-subnav open">
              <a href="javascript:void(0)"><i class="mdi mdi-palette"></i> 学生管理</a>
              <ul class="nav nav-subnav">
                <li> <a href="/student/index">学生信息维护</a> </li>
                <li class="active"> <a href="/student/add">添加学生信息</a> </li>
              </ul>
            </li>
            <li class="nav-item nav-item-has-subnav">
              <a href="javascript:void(0)"><i class="mdi mdi-palette"></i> 教师管理</a>
              <ul class="nav nav-subnav">
                <li> <a href="#">按钮</a> </li>
                <li> <a href="#">卡片</a> </li>
              </ul>
            </li>
            <li class="nav-item nav-item-has-subnav">
              <a href="javascript:void(0)"><i class="mdi mdi-palette"></i> 零件管理</a>
              <ul class="nav nav-subnav">
                <li> <a href="#">按钮</a> </li>
                <li> <a href="#">卡片</a> </li>
              </ul>
            </li>

          </ul>
        </nav>
        
        <div class="sidebar-footer">
          <p class="copyright">Copyright &copy; 2023. Aze All rights reserved.</p>
        </div>
      </div>
      
    </aside>
    <!--End 左侧导航-->
    
    <!--头部信息-->
    <header class="layout-header">
      
      <nav class="navbar navbar-default">
        <div class="topbar">
          
          <div class="topbar-left">
            <div class="aside-toggler">
              <span class="toggler-bar"></span>
              <span class="toggler-bar"></span>
              <span class="toggler-bar"></span>
            </div>
            <span class="navbar-page-title"> 后台首页 </span>
          </div>
          
          <ul class="topbar-right">
            <li class="dropdown dropdown-profile">
              <a href="javascript:void(0)" data-toggle="dropdown">
                <span>欢迎管理员： </span>
                <span><span th:text="#{username}"></span> <span class="caret"></span></span>
              </a>
              <ul class="dropdown-menu dropdown-menu-right">
                <li> <a href="/user/modify"><i class="mdi mdi-lock-outline"></i> 修改密码</a> </li>
                <li class="divider"></li>
                <li class="logout"> <a href="javascript:void(0)"><i class="mdi mdi-logout-variant"></i> 退出登录</a> </li>
              </ul>
            </li>
          </ul>
          
        </div>
      </nav>
      
    </header>
    <!--End 头部信息-->
    
    <!--页面主要内容-->
    <main class="layout-content">

      <div class="container-fluid">

        <div class="row">
          <div class="col-lg-12">
            <div class="card">
              <div class="card-body">

                <form id="form" data-parsley-validate="">
                  <div class="form-group">
                    <label for="name">姓名</label>
                    <input type="text" class="form-control" name="name" id="name" placeholder="输入姓名" required="" data-parsley-trigger="focus">
                  </div>
                  <div class="form-group">
                    <label>性别</label><br/>
                    <label class="radio radio-inline radio-primary" for="radio_man">
                      <input type="radio" name="e" required="" id="radio_man" value="男"><span>男</span>
                    </label>
                    <label class="radio radio-inline radio-primary" for="radio_woman">
                      <input type="radio" name="e" required="" id="radio_woman" value="女"><span>女</span>
                    </label>
                  </div>
                  <div class="form-group">
                    <label for="age">年龄</label>
                    <input type="text" class="form-control" name="age" id="age" placeholder="请输入年龄" required="" data-parsley-trigger="change" data-parsley-type="number" max="150" min="1">
                  </div>
                  <div class="form-group">
                    <label for="address">地址</label>
                    <input type="text" class="form-control" name="address" id="address" placeholder="请输入地址" required="" data-parsley-trigger="change" >
                  </div>
                  <button type="submit" class="btn btn-label btn-primary"><label><i class="mdi mdi-checkbox-marked-circle-outline"></i></label> 确认提交</button>
                  <button type="button" class="btn btn-label btn-default" onclick="javascript:history.back(-1);return false;"><label><i class="mdi mdi-apple-keyboard-control"></i></label>返回</button>
                </form>

              </div>
            </div>
          </div>

        </div>

      </div>

    </main>
    <!--End 页面主要内容-->
  </div>
</div>

<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/perfect-scrollbar.min.js"></script>

<!--对话框插件-->
<script src="/js/jconfirm/jquery-confirm.min.js"></script>
<script type="text/javascript" src="/js/main.min.js"></script>
<script type="text/javascript" src="/js/parsley.js"></script>
<script type="text/javascript" src="/js/i18n_parsley.js"></script>
<script type="text/javascript" src="/js/axios.min.js"></script>
<script type="text/javascript" src="/js/lightyear.js"></script>
<script src="/js/bootstrap-notify.min.js"></script>

<script>

  $('#form').parsley().on('field:validated', function() {
    let ok = $('.parsley-error').length === 0;
    if(ok)
      console.log("校验通过")
    else
      console.log("校验不通过")
  }).on('form:submit', function() {
    submit()
    return false; // Don't submit form for this demo
  });

  function submit () {
    let name = $('#name').val()
    let age = $('#age').val()
    let address = $('#address').val()
    let isMan = $('input:radio:first:checked').val()
    let data = {
      name: name,
        age: age,
        address: address,
      sex : isMan==='男' ? '男' : '女'
    }
    console.log(data)
    $.ajax('/student/add', {
      data: data,
        type: 'POST',
      dataType: 'json',
      success: function (data) {
        if(data.success)
            $.confirm({
                title: '提示',
                content: '添加成功',
                type: 'green',
                buttons: {
                ok: {
                    text: '确定',
                    btnClass: 'btn-primary',
                    keys: ['enter'],
                    action: function(){
                    window.location.href = '/student/index'
                    }
                }
                }
            })
            else
            $.confirm({
                title: '提示',
                content: '添加失败',
                type: 'red',
                buttons: {
                ok: {
                    text: '确定',
                    btnClass: 'btn-primary',
                    keys: ['enter'],
                    action: function(){
                    window.location.href = '/student/index'
                    }
                }
                }
            })
      }
    })
  }

</script>
</body>
</html>